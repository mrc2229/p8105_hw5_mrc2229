---
title: "p8105_hw5_mrc2229"
author: "Matthew Curran"
date: "November 7, 2019"
output: github_document
---

```{r}
library(tidyverse)
library(janitor)
library(rvest)
```

## Problem 1 - Replace the missing values in the iris data set.

```{r}
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))

replace_function = function(x) {
  if(is.numeric(x)) {
    replace_na(x, round(mean(x, na.rm = TRUE), digits=1))
  }
  else if(!is.numeric(x)){
    replace_na(x,"virginica")
  }
}

iris_new = map_df(iris_with_missing, ~replace_function(.x))
```

* The iris_is_missing data set has been updated with a function that relpaces missing enteries for numeric variables with the mean of non-missing values and missing character variables are filled in with "virginica". This new dataset is called iris_new.


## Problem 2 - Create a tidy dataframe from a longitudinal study that included a control arm and an experimental arm.

```{r}
data_function = function(y) {
  data = read.csv(y)
}

long_study_tib = tibble(
  file_name = list.files(path = "./data/"),
  path = str_c("./data/", file_name)
)

long_study = long_study_tib %>%
  mutate(lists = map(path, data_function)) %>%
  unnest(cols=lists)%>%
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "value"
  ) %>%
  separate(file_name, into = c("study_arm", "subject_id"), sep="_")%>%
  mutate(
    study_arm = recode(study_arm, con = "Control Group", exp = "Experimental Group")
  ) %>%
  select(-path)%>%
  mutate(
    subject_id = str_replace(subject_id, ".csv",""),
    week = str_replace(week,"week_","")
  )
```

